/*! For license information please see hall-plan.min.js.LICENSE */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["hall-plan"]=t():e.HallPlan=t()}(window,(function(){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t,a){},function(e,t,a){"use strict";a.r(t);a(0);function n(e){for(var t,a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];if(e.classList)(t=e.classList).add.apply(t,a);else{for(var s=e.className.split(" ").filter((function(e){return e.length>0})),r=0,l=a;r<l.length;r++){var i=l[r];s.indexOf(i)<0&&s.push(i)}e.className=s.join(" ")}}function s(e){for(var t,a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];if(e.classList)(t=e.classList).remove.apply(t,a);else{for(var s=e.className.split(" ").filter((function(e){return e.length>0})),r=0,l=a;r<l.length;r++){var i=l[r],o=s.indexOf(i);o>=0&&s.splice(o,1)}e.className=s.join(" ")}}var r=function(){return(r=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},l=function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),s=0;for(t=0;t<a;t++)for(var r=arguments[t],l=0,i=r.length;l<i;l++,s++)n[s]=r[l];return n},i=function(){function e(e){var t=this;this.activeSeatPos=null,this.handleMouseClick=function(e){var a=function e(t,a){return null===t?null:t.matches(a)?t:t.parentNode&&t.parentNode.nodeType===Node.ELEMENT_NODE?e(t.parentNode,a):null}(e.target,".hall-plan__seat");if(a){var n={row:+a.dataset.row,seat:+a.dataset.seat},s="click"===e.type?t.onSeatClick:t.onSeatContextMenu;t.selectable&&"click"===e.type&&t.setSeatActive(n),s&&s.call(t,n,e)}},this.scheme=e.scheme,this.seatDirection=e.scheme.seatDirection||"ltr",this.seatStates=e.scheme.seatStates||{},this.rowNumbersLeft=void 0===e.rowNumbersLeft||e.rowNumbersLeft,this.rowNumbersRight=void 0===e.rowNumbersRight||e.rowNumbersRight,this.selectable=!!e.selectable,this.screenText=void 0!==e.screenText?e.screenText:"Screen",this.showScreen=void 0===e.showScreen||e.showScreen,this.onSeatClick=e.onSeatClick,this.onSeatContextMenu=e.onSeatContextMenu,e.el?(this.elem="string"==typeof e.el||e.el instanceof String?document.querySelector(e.el):e.el,this.elemIsOur=!1):(this.elem=document.createElement("div"),this.elemIsOur=!0),this.bindEventHandlers()}return e.prototype.destroy=function(){this.unbindEventHandlers(),this.elemIsOur&&this.elem.parentNode?this.elem.parentNode.removeChild(this.elem):this.elemIsOur||(this.elem.className=this.elem.className.replace("hall-plan","")),this.elem.innerHTML="",s(this.elem,"hall-plan","hall-plan--rtl","hall-plan--ltr")},e.prototype.getRowCount=function(){return this.scheme.rows.length},e.prototype.getSeatCount=function(e){if(e<=0||e>this.getRowCount())throw new Error("Row number is out of range");return this.scheme.rows[e-1].reduce((function(e,t){return e+t.seats}),0)},e.prototype.getTotalSeatCount=function(){for(var e=0,t=1;t<=this.getRowCount();t++)e+=this.getSeatCount(t);return e},e.prototype.getSeatStates=function(e,t){for(var a=[],n=0,s=Object.keys(this.seatStates);n<s.length;n++)for(var r=s[n],l=0,i=this.seatStates[r];l<i.length;l++){var o=i[l];if(o[0]===e&&o[1]===t){a.push(r);break}}return a},e.prototype.setSeatStates=function(e,t,a){for(var n=0,s=Object.keys(this.scheme.seatStates);n<s.length;n++){var r=s[n];a.indexOf(r)?this.setSeatState(e,t,r):this.unsetSeatState(e,t,r)}this.updateAllSeatStates()},e.prototype.hasSeatState=function(e,t,a){var n=this.scheme.seatStates[a];if(n)for(var s=0,r=n;s<r.length;s++){var l=r[s];if(l[0]===e&&l[1]===t)return!0}return!1},e.prototype.setSeatState=function(e,t,a){this.hasSeatState(e,t,a)||(this.scheme.seatStates[a]||(this.scheme.seatStates[a]=[]),this.scheme.seatStates[a].push([e,t]),this.updateSeatStates(e,t))},e.prototype.unsetSeatState=function(e,t,a){var n=this.scheme.seatStates[a];if(n)for(var s=0;s<n.length;s++){var r=this.scheme.seatStates[a][s];if(r[0]===e&&r[1]===t){n.splice(s,1),0===n.length&&delete this.scheme.seatStates[a],this.updateSeatStates(e,t);break}}},e.prototype.toggleSeatState=function(e,t,a){this.hasSeatState(e,t,a)?this.unsetSeatState(e,t,a):this.setSeatState(e,t,a)},e.prototype.getActiveSeat=function(){return this.activeSeatPos},e.prototype.isSeatActive=function(e){if(this.activeSeatPos){var t=this.activeSeatPos,a=t.row,n=t.seat;return a===e.row&&n===e.seat}return!1},e.prototype.setSeatActive=function(e){if(!e||!this.isSeatActive(e)){var t=this.getActiveSeat();if(t){var a=t.row,l=t.seat;(i=this.elem.querySelector('.hall-plan__seat[data-row="'+a+'"][data-seat="'+l+'"]'))&&s(i,"hall-plan__seat--active")}}if(e&&!this.isSeatActive(e)){var i;a=e.row,l=e.seat;(i=this.elem.querySelector('.hall-plan__seat[data-row="'+a+'"][data-seat="'+l+'"]'))&&n(i,"hall-plan__seat--active")}this.activeSeatPos=e?r({},e):null},e.prototype.getMaxSeatCountInRow=function(){for(var e=0,t=1;t<=this.getRowCount();t++){var a=this.getSeatCount(t);a>e&&(e=a)}return e},e.prototype.render=function(){var e=document.createElement("div");e.className="hall-plan__rows";for(var t=1;t<=this.getRowCount();t++){var a,s=document.createElement("div");if(s.className="hall-plan__row",s.dataset.row=t.toString(),this.rowNumbersLeft)(a=document.createElement("div")).className="hall-plan__row-number",a.textContent=t.toString(),s.appendChild(a);if(s.appendChild(this.renderRowContent(t)),this.rowNumbersRight)(a=document.createElement("div")).className="hall-plan__row-number",a.textContent=t.toString(),s.appendChild(a);e.appendChild(s)}var r=["hall-plan","hall-plan--"+this.seatDirection];return this.selectable&&r.push("hall-plan--selectable"),(this.selectable||this.onSeatClick||this.onSeatContextMenu)&&r.push("hall-plan--clickable"),n.apply(void 0,l([this.elem],r)),this.elem.innerHTML="",this.showScreen&&this.elem.appendChild(this.renderScreen()),this.elem.appendChild(e),this.elem},e.prototype.renderScreen=function(){var e=document.createElement("div");(e.className="hall-plan__screen-wrap",this.rowNumbersLeft)&&((a=document.createElement("div")).className="hall-plan__screen-spacer",e.appendChild(a));var t=document.createElement("div");t.className="hall-plan__screen",t.innerHTML='<svg id="Слой_2" data-name="Слой 2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 694 60"><defs><style>.cls-1{fill:url(#linear-gradient);}.cls-2{fill:#d9d9d9;}.cls-3{fill:#e6e6e6;}</style><linearGradient id="linear-gradient" x1="346.5" y1="60" x2="346.5" y2="16.89" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#e6e6e6"/></linearGradient></defs><title>Screen</title><path class="cls-1" d="M22,43,17,60H676l-4-19S457,15,338,17,22,43,22,43Z"/><path class="cls-2" d="M495.88,27.34c80.23,3.88,167,14.67,177.74,16a2.26,2.26,0,0,0,1.9-.67l17.87-18.38a2.14,2.14,0,0,0-1.19-3.61c-16.34-2.23-79.51-10.39-162.91-15.59C436.24-.69,353.5,0,346.51.06s-88.75-.75-181.8,5.05C81.31,10.31,18.14,18.47,1.8,20.7A2.14,2.14,0,0,0,.61,24.31L18.48,42.69a2.26,2.26,0,0,0,1.9.67c10.71-1.35,97.51-12.14,177.74-16,77.62-3.76,144.46-3.06,148.39-3S418.26,23.58,495.88,27.34Z"/><path class="cls-3" d="M495,29.5C574.79,33.34,661.09,44,671.74,45.36a2.23,2.23,0,0,0,1.88-.66l17.77-18.19a2.12,2.12,0,0,0-1.18-3.58c-16.24-2.2-79.05-10.29-162-15.43-92.51-5.74-174.77-5.07-181.73-5s-88.24-.74-180.75,5C82.84,12.64,20,20.73,3.79,22.93a2.12,2.12,0,0,0-1.18,3.58L20.38,44.7a2.23,2.23,0,0,0,1.88.66C32.91,44,119.21,33.34,199,29.5c77.17-3.72,143.62-3,147.53-3S417.85,25.78,495,29.5Z"/></svg>\n',e.appendChild(t);var a,n=document.createElement("div");(n.className="hall-plan__screen-text",n.textContent=this.screenText,t.appendChild(n),this.rowNumbersRight)&&((a=document.createElement("div")).className="hall-plan__screen-spacer",e.appendChild(a));return e},e.prototype.renderRowContent=function(e){var t=document.createElement("div");t.className="hall-plan__row-content";for(var a=this.getMaxSeatCountInRow(),n=(100/a).toFixed(4)+"%",s=0,r=1,l=0,i=this.scheme.rows[e-1];l<i.length;l++){var o=i[l],c=o.offset||0;s+=c;for(var h=0;h<c;h++){(m=document.createElement("div")).className="hall-plan__spacer",m.style.width=n,t.appendChild(m)}var u=o.seats||0;s+=u;for(h=0;h<u;h++){var p=this.getSeatStates(e,r).map((function(e){return"hall-plan__seat--state_"+e}));this.activeSeatPos&&this.activeSeatPos.row===e&&this.activeSeatPos.seat===r&&p.push("hall-plan__seat--active"),p.unshift("hall-plan__seat"),(m=document.createElement("div")).className="hall-plan__spacer",m.style.width=n;var d=document.createElement("div");d.className=p.join(" "),d.dataset.row=e.toString(),d.dataset.seat=r.toString(),d.textContent=r.toString(),m.appendChild(d),t.appendChild(m),r++}}var f=a-s;for(h=0;h<f;h++){var m;(m=document.createElement("div")).className="hall-plan__spacer",m.style.width=n,t.appendChild(m)}return t},e.prototype.updateAllSeatStates=function(){for(var e=this.elem.querySelectorAll(".hall-plan__seat"),t=0,a=Array.prototype.slice.call(e);t<a.length;t++){var n=a[t],s=parseInt(n.dataset.row,10),r=parseInt(n.dataset.seat,10),l=this.getSeatStates(s,r).map((function(e){return"hall-plan__seat--state_"+e}));l.unshift("hall-plan__seat"),n.className=l.join(" ")}},e.prototype.updateSeatStates=function(e,t){var a=this.elem.querySelector('.hall-plan__seat[data-row="'+e+'"][data-seat="'+t+'"]');if(a){var n=this.getSeatStates(e,t).map((function(e){return"hall-plan__seat--state_"+e}));n.unshift("hall-plan__seat"),a.className=n.join(" ")}},e.prototype.bindEventHandlers=function(){this.elem.addEventListener("click",this.handleMouseClick),this.elem.addEventListener("contextmenu",this.handleMouseClick)},e.prototype.unbindEventHandlers=function(){this.elem.removeEventListener("click",this.handleMouseClick),this.elem.removeEventListener("contextmenu",this.handleMouseClick)},e}();t.default=i}]).default}));
//# sourceMappingURL=hall-plan.min.js.map